#pragma once

#define MEMORY_DUMPER_DEVICE 0x8000
#define KERNEL_MAX_ADDR 0xFFFFFFFFFFFFFFFF
#define KERNEL_MIN_ADDR 0xFFFF000000000000

#define IOCTL_DUMP_KERNEL_MODULE CTL_CODE(MEMORY_DUMPER_DEVICE, \
	0x8000, METHOD_NEITHER, FILE_ANY_ACCESS)

#define IOCTL_VERIFY_ADDRESS CTL_CODE(MEMORY_DUMPER_DEVICE, \
	0x8001, METHOD_NEITHER, FILE_ANY_ACCESS)

#define MAX_NAME_LENGTH 20

typedef struct _MODULE_DATA {
	bool isAddr = false;
	UINT64 address = 0;
	UINT64 size = 0;
	char moduleName[MAX_NAME_LENGTH] = { 0 };
} MD_MODULE_DATA, *PMD_MODULE_DATA;